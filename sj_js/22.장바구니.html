<html>
  <head>
    <style>
      #container {
        width: 800px;
        margin: 50px auto;
      }

      li {
        display: flex;
        align-items: center;
        border-bottom: 1px solid #ddd;
      }
      h5 {
        width: 500px;
        padding: 0 20px;
      }

      img {
        height: 100px;
      }
      
      button {
        font-size: 20px; 
        padding: 5px 10px;
        margin-left: auto;
        margin-right: 20px;
      }

    </style>


  </head>
  <body>
    <h1>장바구니</h1>
    <div id="container"></div>
    <button onclick="deleteAllBtn()">전체삭제</button>
    <script>
      //로컬에 있는 상품을 받아온다.
      //print한다.
      var products = [
			{ id: 1, name: '사과', price: 1000, src: 'img1.jpg' },
			{ id: 2, name: '귤', price: 2000, src: 'img2.jpg' },
			{ id: 3, name: '포도', price: 3000, src: 'img3.jpg' },
			{ id: 4, name: '감', price: 4000, src: 'img4.jpg' },
			{ id: 5, name: '배', price: 5000, src: 'img5.jpg' },
			{ id: 6, name: '멜론', price: 6000, src: 'img6.jpg' },
			{ id: 7, name: '수박', price: 7000, src: 'img7.jpg' },
			{ id: 8, name: '자두', price: 8000, src: 'img8.jpg' },
			{ id: 9, name: '복숭아', price: 9000, src: 'img9.jpg' },
		];
      const container = document.querySelector('#container');
      var html = '';
      var text = '';
      var cart = [];
  
      function deleteAllBtn () {
        //로컬을 다 지우고, cart를 비워준다 
        var cartItem = localStorage.removeItem('cartItem');
        cart = [];
        print();
      };    

      // cart를 새로 만든다.
      // 새로만든 cart를 localStorage에 저장한다.
      // print한다. 
    
      function delBtn (id) {
        var cartItem = cart.filter(item => item.id !== id);
        cart = cartItem;
        cartIds = cart.map(item => item.id);
        stringCart = JSON.stringify(cartIds);
        localStorage.setItem('cartItem', cartIds);
        print();
      }

      init();
      function init() {
        var cartItem = localStorage.getItem('cartItem');
        var cartIds = JSON.parse(cartItem);
        console.log(cartIds); //[1,2,3,5,6,4]
        cart = products.filter(item => cartIds.indexOf(item.id) !== -1);
        print();
      };

      print();


      function print() {
        html = '';
        for ( var i = 0; i < cart.length; i++) {
          text = `
            <li>
              <img src="img/${cart[i].src}" />
              <h5>${cart[i].name}</h5>
              <button onclick="delBtn(${cart[i].id})">삭제</button>
            </li>
          `;
          html = html + text;
        }

        container.innerHTML = html;

      };

    </script>
  </body>
</html>