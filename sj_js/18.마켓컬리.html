<html>
<head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    header {
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
      color: red;
      background: rgba(255, 255, 255, .8);
      width: 100%;
      height: 100px;
      gap: 10px;
      position: fixed;
      top: 0;
      left: 0;
    }
    img {
      width: 100%;
    }
    button {
      width: 100%;
      padding: 10px 0;
      font-size: 20px;
    }
    #container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-gap: 20px;
      width: 1000px;
      margin: 50px auto;
    }

  </style>
</head>
<body>
  <header>
    장바구니<h1 id="cartCount" onclick="goCart()"
    >0</h1>개
  </header>
  <div id="container"></div>
  <script>
   var container = document.querySelector('#container'); 
   var cartCount = document.querySelector('#cartCount');
   var html = '';
   var text = '';
   var cart = [];
   var stringCart;
	
    var products = [
			{ id: 1, name: '사과', price: 1000, src: 'img1.jpg' },
			{ id: 2, name: '귤', price: 2000, src: 'img2.jpg' },
			{ id: 3, name: '포도', price: 3000, src: 'img3.jpg' },
			{ id: 4, name: '감', price: 4000, src: 'img4.jpg' },
			{ id: 5, name: '배', price: 5000, src: 'img5.jpg' },
			{ id: 6, name: '멜론', price: 6000, src: 'img6.jpg' },
			{ id: 7, name: '수박', price: 7000, src: 'img7.jpg' },
			{ id: 8, name: '자두', price: 8000, src: 'img8.jpg' },
			{ id: 9, name: '복숭아', price: 9000, src: 'img9.jpg' },
	  ];

  init();
 
  function init() {
    // 로컬스토지에 아이템이 있으면 setCart에 반영한다.
    var storageCart = localStorage.getItem('cartItem');
    if (storageCart) {
      cart = JSON.parse(storageCart);
      setCart();
    }
  }

  function goCart() {
    window.location = `22.장바구니.html`;
  }

  function detail(id) {
    window.location = `19.마켓컬리상세.html?id=` + id;
  }
  
  function setCart() {
    cartCount.innerHTML = cart.length;
  }
  
  function addToCart(id) {
    //cart에 해당상품이 있으면 안넣어주고 없으면 넣어준다
    //로컬에 해당상품을 저장한다
    if (cart.indexOf(id) === -1) {
      cart.push(id); //[1,2] 
      stringCart = JSON.stringify(cart);
      localStorage.setItem('cartItem', stringCart);
      setCart();
    }
  }

  function print() {
    html = '';
    for (var i = 0; i < products.length; i++) {
      text = `
        <div>
          <img src="img/${products[i].src}" onclick="detail(${products[i].id})" />
          <h1>${products[i].name}</h1>
          <h3>${products[i].price}원<h3>
          <button onclick="addToCart(${products[i].id})">담기</button>
        </div>
      `;
      html = html + text;
    }

    container.innerHTML = html;

  };


  print();





















  </script>
</body>
</html>